PROJECT(IGSTK-VT-JUnit)

INCLUDE(Dart)
ENABLE_TESTING()

FILE(GLOB CLASSPATH ${IGSTK-VT-JUnit_SOURCE_DIR}/../lib/*.jar)

FILE(GLOB_RECURSE CLASSES ${IGSTK-VT-JUnit_SOURCE_DIR}/src/*.java)
STRING(REPLACE ".jar" ".jar:" CLASSPATH ${CLASSPATH})

SET(CLASSPATH "${CLASSPATH}:${IGSTK-VT-JUnit_SOURCE_DIR}/lib/junit.jar:${IGSTK-VT-JUnit_SOURCE_DIR}/../classes:${CLASSPATH}:${IGSTK-VT-JUnit_SOURCE_DIR}/classes:${CLASSPATH}:${IGSTK-VT-JUnit_SOURCE_DIR}/../properties")

ADD_CUSTOM_TARGET(COMPILE ALL)

ADD_CUSTOM_COMMAND(
        TARGET COMPILE
        COMMAND ant
        ARGS -f ../build.xml compile-junit
        )

FOREACH(JUNIT-CLASS ${CLASSES})
        STRING(REPLACE ".java" "" JUNIT-CLASS ${JUNIT-CLASS})
        STRING(REPLACE "${IGSTK-VT-JUnit_SOURCE_DIR}/src/" "" JUNIT-CLASS ${JUNIT-CLASS})
        STRING(REPLACE "/" "." JUNIT-CLASS ${JUNIT-CLASS})
        MESSAGE("${JUNIT-CLASS}")
        ADD_TEST(IGSTK-VT-JUnit-${JUNIT-CLASS} java -cp ${CLASSPATH} org.junit.runner.JUnitCore ${JUNIT-CLASS})
ENDFOREACH(JUNIT-CLASS ${CLASSES})